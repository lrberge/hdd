<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Transforms text data into a HDD file — txt2hdd • hdd</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Transforms text data into a HDD file — txt2hdd"><meta property="og:description" content="Imports text data and saves it into a HDD file. It uses read_delim_chunked
to extract the data. It also allows to preprocess the data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hdd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/hdd_walkthrough.html">hdd walkthrough</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Transforms text data into a HDD file</h1>
    
    <div class="hidden name"><code>txt2hdd.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Imports text data and saves it into a HDD file. It uses <code><a href="https://readr.tidyverse.org/reference/read_delim_chunked.html" class="external-link">read_delim_chunked</a></code>
to extract the data. It also allows to preprocess the data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">txt2hdd</span><span class="op">(</span></span>
<span>  <span class="va">path</span>,</span>
<span>  <span class="va">dirDest</span>,</span>
<span>  chunkMB <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  <span class="va">rowsPerChunk</span>,</span>
<span>  <span class="va">col_names</span>,</span>
<span>  <span class="va">col_types</span>,</span>
<span>  <span class="va">nb_skip</span>,</span>
<span>  <span class="va">delim</span>,</span>
<span>  <span class="va">preprocessfun</span>,</span>
<span>  replace <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  encoding <span class="op">=</span> <span class="st">"UTF-8"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  locale <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>path</dt>
<dd><p>Character vector that represents the path to the data. Note that
it can be equal to patterns if multiple files with the same name are to be imported
(if so it must be a fixed pattern, NOT a regular expression).</p></dd>


<dt>dirDest</dt>
<dd><p>The destination directory, where the new HDD data should be saved.</p></dd>


<dt>chunkMB</dt>
<dd><p>The chunk sizes in MB, defaults to 500MB. Instead of using this
argument, you can alternatively use the argument <code>rowsPerChunk</code> which decides
the size of chunks in terms of lines.</p></dd>


<dt>rowsPerChunk</dt>
<dd><p>Number of rows per chunk. By default it is missing: its value
is deduced from argument <code>chunkMB</code> and the size of the file. If provided,
replaces any value provided in <code>chunkMB</code>.</p></dd>


<dt>col_names</dt>
<dd><p>The column names, by default is uses the ones of the data set.
If the data set lacks column names, you must provide them.</p></dd>


<dt>col_types</dt>
<dd><p>The column types, in the <code>readr</code> fashion. You can use <code><a href="guess_col_types.html">guess_col_types</a></code>
to find them.</p></dd>


<dt>nb_skip</dt>
<dd><p>Number of lines to skip.</p></dd>


<dt>delim</dt>
<dd><p>The delimiter. By default the function tries to find the delimiter, but sometimes it fails.</p></dd>


<dt>preprocessfun</dt>
<dd><p>A function that is applied to the data before saving. Default
is missing. Note that if a function is provided, it MUST return a data.frame,
anything other than data.frame is ignored.</p></dd>


<dt>replace</dt>
<dd><p>If the destination directory already exists, you need to set the
argument <code>replace=TRUE</code> to overwrite all the HDD files in it.</p></dd>


<dt>encoding</dt>
<dd><p>Character scalar containing the encoding of the file to be read.
By default it is "UTF-8" and is passed to the <code>readr</code> function <code><a href="https://readr.tidyverse.org/reference/locale.html" class="external-link">locale</a></code> which is used
in <code><a href="https://readr.tidyverse.org/reference/read_delim_chunked.html" class="external-link">read_delim_chunked</a></code> (the reading function). A common encoding in Western Europe is
"ISO-8859-1" (simply use "file filename" in a non-Windows console to get the encoding).</p>
<p>Note that this argument is ignored if the argument <code>locale</code> is not NULL.</p></dd>


<dt>verbose</dt>
<dd><p>Logical scalar or <code>NULL</code> (default). If <code>TRUE</code>, then the evolution of
the importing process as well as the time to import are reported.
If <code>NULL</code>, it becomes <code>TRUE</code> when the data to import is greater than 5GB or there are
more than one chunk.</p></dd>


<dt>locale</dt>
<dd><p>Either <code>NULL</code> (default), either an object created with <code><a href="https://readr.tidyverse.org/reference/locale.html" class="external-link">locale</a></code>.
This object will be passed to the reading function <code><a href="https://readr.tidyverse.org/reference/read_delim_chunked.html" class="external-link">read_delim_chunked</a></code> and handles
how the data is imported.</p></dd>


<dt>...</dt>
<dd><p>Other arguments to be passed to <code><a href="https://readr.tidyverse.org/reference/read_delim_chunked.html" class="external-link">read_delim_chunked</a></code>,
<code>quote = ""</code> can be interesting sometimes.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>This function does not return anything in R. Instead it creates a folder
on disk containing <code>.fst</code> files. These files represent the data that has been
imported and converted to the <code>hdd</code> format.</p>


<p>You can then read the created data with the function <code><a href="hdd.html">hdd()</a></code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function uses <code><a href="https://readr.tidyverse.org/reference/read_delim_chunked.html" class="external-link">read_delim_chunked</a></code> from <code>readr</code>
to read a large text file per chunk, and generate a HDD data set.</p>
<p>Since the main function for importation uses <code>readr</code>, the column specification
must also be in readr's style (namely <code><a href="https://readr.tidyverse.org/reference/cols.html" class="external-link">cols</a></code> or <code><a href="https://readr.tidyverse.org/reference/cols.html" class="external-link">cols_only</a></code>).</p>
<p>By default a guess of the column types is made on the first 10,000 rows. The
guess is the application of <code><a href="guess_col_types.html">guess_col_types</a></code> on these rows.</p>
<p>Note that by default, columns that are found to be integers are imported as double
(in want of integer64 type in readr). Note that for large data sets, sometimes
integer-like identifiers can be larger than 16 digits: in these case you must
import them as character not to lose information.</p>
<p>The delimiter is found with the function <code><a href="guess_delim.html">guess_delim</a></code>, which
uses the guessing from <code><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></code>. Note that fixed width
delimited files are not supported.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>See <code><a href="hdd.html">hdd</a></code>, <code>sub-.hdd</code> and <code>cash-.hdd</code>
for the extraction and manipulation of out of memory data. For importation of
HDD data sets from text files: see <code>txt2hdd</code>.</p>
<p>See <code><a href="hdd_slice.html">hdd_slice</a></code> to apply functions to chunks of data (and create
HDD objects) and <code><a href="hdd_merge.html">hdd_merge</a></code> to merge large files.</p>
<p>To create/reshape HDD objects from memory or from other HDD objects, see
<code><a href="write_hdd.html">write_hdd</a></code>.</p>
<p>To display general information from HDD objects: <code><a href="origin.html">origin</a></code>,
<code><a href="summary.hdd.html">summary.hdd</a></code>, <code><a href="print.hdd.html">print.hdd</a></code>,
<code><a href="dim.hdd.html">dim.hdd</a></code> and <code><a href="names.hdd.html">names.hdd</a></code>.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Laurent Berge</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Toy example with iris data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># we create a text file on disk</span></span></span>
<span class="r-in"><span><span class="va">iris_path</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">fwrite</span><span class="op">(</span><span class="va">iris</span>, <span class="va">iris_path</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># destination path</span></span></span>
<span class="r-in"><span><span class="va">hdd_path</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># reading the text file with HDD, with approx. 50 rows per chunk:</span></span></span>
<span class="r-in"><span><span class="fu">txt2hdd</span><span class="op">(</span><span class="va">iris_path</span>, dirDest <span class="op">=</span> <span class="va">hdd_path</span>, rowsPerChunk <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">base_hdd</span> <span class="op">=</span> <span class="fu"><a href="hdd.html">hdd</a></span><span class="op">(</span><span class="va">hdd_path</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">base_hdd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hard drive data of 7.28 KB. Made of 3 files.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location: C:/Users/lrberge/AppData/Local/Temp/Rtmpa0wfuK/file56884ab37227/</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 150 lines, 5 variables.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same example with preprocessing</span></span></span>
<span class="r-in"><span><span class="va">sl_keep</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Length</span>, <span class="fl">40</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fun</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># we keep only some observations &amp; vars + renaming</span></span></span>
<span class="r-in"><span>  <span class="va">res</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="va">Sepal.Length</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sl_keep</span>, <span class="fu">.</span><span class="op">(</span>sl <span class="op">=</span> <span class="va">Sepal.Length</span>, <span class="va">Species</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="co"># we create some variables</span></span></span>
<span class="r-in"><span>  <span class="va">res</span><span class="op">[</span>, <span class="va">sl2</span> <span class="op">:=</span> <span class="va">sl</span><span class="op">**</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">res</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># reading with preprocessing</span></span></span>
<span class="r-in"><span><span class="va">hdd_path_preprocess</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">txt2hdd</span><span class="op">(</span><span class="va">iris_path</span>, <span class="va">hdd_path_preprocess</span>,</span></span>
<span class="r-in"><span>    preprocessfun <span class="op">=</span> <span class="va">fun</span>, rowsPerChunk <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">base_hdd_preprocess</span> <span class="op">=</span> <span class="fu"><a href="hdd.html">hdd</a></span><span class="op">(</span><span class="va">hdd_path_preprocess</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">base_hdd_preprocess</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hard drive data of 4.11 KB. Made of 3 files.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Location: C:/Users/lrberge/AppData/Local/Temp/Rtmpa0wfuK/file56884cd168ba/</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121 lines, 3 variables.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Laurent Berge.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

